// SPDX-License-Identifier: GPL-3.0
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//
//      MMWKd:..                                                                                    ..:dKWMM
//      MKl.                                                                                            .lKW
//      O'       ..''''''''''''.     .''''''.     .'''''.      .''''''''''''''.     .''''''''''''..       'O
//      '     .ckKNNWNWWWWWWWWWk.   .xNWWNWNl    ,0WWWWW0,     lNWWWWWWWWWNWNk'    ;0NNNWWWWWWWWNNKkc.     '
//           ,OWMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMMMM0,    ;KMMMMMMMMMMMMMMMMWO,
//          .kMMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMMM0,    ;KMMMMMMMMMMMMMMMMMMMk.
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMM0,    :KMMMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMM0,    :KMMMMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMM0,    ;0NNWWMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMM0,     .'.',;lkNMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMK;              ,kWMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMX:    .:oxxdc'    .dWMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMWd.   ,OWMMMMMXl.   '0MMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMX;   .kMMMMMMMMK,   .xMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMM0'   .OMMMMMMMMX;   .xMMMMMMMMMMMM0'
//          .OMMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMK,    lNMMMMMMWx.   '0MMMMMMMMMMMMO.
//           lNMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMWd.   .:x0KKKkc.   .dWMMMMMMMMMMMNl
//      .    .c0WMMMMMMMMMMMMMMO.   .kMMMMMWo    ,KMMMMMK,     lWMMMMNd.     ....     .xNMMMMMMMMMMW0c.    .
//      l      .,lddxxxxxxxxxxxc.    :xxxxxd,    .lxxxxxl.     ,dxxxxxd:.            .cdxxxxxxxxddl,.      l
//      No.                                                                                              .oN
//      MW0l'                                                                                          'l0WM
//      MMMWKd;.                                                                                    .;dKWMMM
//
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//                                                                                                                                                                                  //
//      @dev            ::              Aron Mauritala Ayuk                                                                                                                                          //
//      @msg            ::              stereo@iii6.xyz                                                                                                                                   //
//      @github         ::              @stereoIII6
//      @twitter        ::              @stereoIII6                                                                                                                                              //
//                                                                                                                                                                                  //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//                                                                                                                                                                                  //
//      @dev            ::              Juan Xavier Valverde                                                                                                                                    //
//      @msg            ::              juanxavier@iii6.xyz                                                                                                                               //
//      @twitter        ::              @JuanXavier                                                                                                                                             //
//      @github         ::              @JuanXavier                                                                                                                                             //
//                                                                                                                                                                                  //                                                                                                                                                                                 //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//                                                                                                                                                                                  //
//      @company        ::              Fractio Holding                                                                                                                                                                       //
//      @title          ::              iii6 Coin Model                                                                                                                            //
//      @description    ::              ERC20 Model Preset Contract                                                                                                                           //
//      @version        ::              0.0.1                                                                                                                                       //
//      @purpose        ::              ERC20 Model Preset                                                                                                          //
//                                                                                                                                                                                  //
//                                                                                                                                                                                  //
//                                                                                                                                                                                  //
//                                                                                                                                                                                  //
//                                                                                                                                                                                  //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

pragma solidity ^0.8.7;

import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Pausable.sol";
import "../Oracles/iii6PriceConsumer.sol";
import "../Math/iii6PriceMath.sol";
import "./iii6Safes.sol";
import "../Misc/iii6GlobalEnums.sol";

contract iii6CoinModel is
    ERC20,
    ERC20Pausable,
    ERC20Burnable,
    Ownable,
    iii6PriceMath,
    iii6GlobalEnums
{
    /**
     * @dev this contract is a factory contract to deploy iii6CoinModel & iii6DiaModel
     */
    // ██╗███╗░░██╗██╗████████╗██╗░█████╗░██╗░░░░░██╗░██████╗░█████╗░████████╗██╗░█████╗░███╗░░██╗
    // ██║████╗░██║██║╚══██╔══╝██║██╔══██╗██║░░░░░██║██╔════╝██╔══██╗╚══██╔══╝██║██╔══██╗████╗░██║
    // ██║██╔██╗██║██║░░░██║░░░██║███████║██║░░░░░██║╚█████╗░███████║░░░██║░░░██║██║░░██║██╔██╗██║
    // ██║██║╚████║██║░░░██║░░░██║██╔══██║██║░░░░░██║░╚═══██╗██╔══██║░░░██║░░░██║██║░░██║██║╚████║
    // ██║██║░╚███║██║░░░██║░░░██║██║░░██║███████╗██║██████╔╝██║░░██║░░░██║░░░██║╚█████╔╝██║░╚███║
    // ╚═╝╚═╝░░╚══╝╚═╝░░░╚═╝░░░╚═╝╚═╝░░╚═╝╚══════╝╚═╝╚═════╝░╚═╝░░╚═╝░░░╚═╝░░░╚═╝░╚════╝░╚═╝░░╚══╝
    /**
     * @dev declaration of storage vars
     */
    uint256 public rate;
    uint256 public PUB_SUPPLY;
    uint256 public MAX_SUPPLY;
    uint256 private r;
    bool private burns;
    bool private pauses;
    string public title;

    /**
     * @dev declaration of enums structs and arrays
     */
    Coins private ocoin;
    struct Rates {
        uint256 rateid;
        uint256 rate;
        Coins ocoin;
    }
    Rates[] private rates;

    /**
     * @dev creates an instance of iii6CoinModel
     * @param _name token name
     * @param _sym token symbol
     * @param _rate token rate
     * @param _supply max token supply // if 0-infinte
     * @param _burn bool burnable
     * @param _pause bool pauseble
     * @param _curr denomintaor currency // 0-eth 1-gascoin 2-xCur 2-yCur >4-usdc
     */
    constructor(
        string memory _name, // Token Name
        string memory _sym, // Token Symbol
        uint256 _rate, // Token Price in USD // 100 == 1 usd // 100000 = 1ETH
        uint256 _supply, // Token Max Supply
        bool _burn, // Burnable Option
        bool _pause,
        uint256 _curr // 1-eth 2-usd 3-xCur 4-yCur
    ) ERC20(_name, _sym) {
        _setRate(_rate); /** @dev see _setRate() :: line138 */
        MAX_SUPPLY = _supply;
        title = _name;
        burns = _burn;
        pauses = _pause;
        ocoin = _setCurr(_curr); /** @dev see _setRate() :: line181 */
        rates[r] = Rates(r, _rate, ocoin); /** @dev see Rates{} :: line97 */
    }

    // ██████╗░██████╗░██╗██╗░░░██╗░█████╗░████████╗███████╗  ███████╗███╗░░██╗██╗░░██╗
    // ██╔══██╗██╔══██╗██║██║░░░██║██╔══██╗╚══██╔══╝██╔════╝  ██╔════╝████╗░██║╚██╗██╔╝
    // ██████╔╝██████╔╝██║╚██╗░██╔╝███████║░░░██║░░░█████╗░░  █████╗░░██╔██╗██║░╚███╔╝░
    // ██╔═══╝░██╔══██╗██║░╚████╔╝░██╔══██║░░░██║░░░██╔══╝░░  ██╔══╝░░██║╚████║░██╔██╗░
    // ██║░░░░░██║░░██║██║░░╚██╔╝░░██║░░██║░░░██║░░░███████╗  ██║░░░░░██║░╚███║██╔╝╚██╗
    // ╚═╝░░░░░╚═╝░░╚═╝╚═╝░░░╚═╝░░░╚═╝░░╚═╝░░░╚═╝░░░╚══════╝  ╚═╝░░░░░╚═╝░░╚══╝╚═╝░░╚═╝

    /**
     * @dev sets token price in denomination currency ocoin
     * @param _newRate token price in $ocoin (denomination currency)
     * denomination currency can be set in setCurr()
     * @return uint256 rate in gascoin
     */
    function _setRate(uint256 _newRate) internal returns (uint256) {
        iii6PriceMath pm;
        if (ocoin == Coins.WETH) {
            uint256 eP = pm.coinPriceOfEth(_newRate); /** @dev see iii6PriceMath.sol coinPriceOfEth() :: line138 */
            require(eP > 0);
            rates[r] = Rates(r, eP, ocoin);
            r++;
            return rate = eP;
        } else if (ocoin == Coins.GASCOIN) {
            uint256 gP = _newRate;
            require(gP > 0);
            rates[r] = Rates(r, gP, ocoin);
            r++;
            return rate = gP;
        } else if (ocoin == Coins.XXX) {
            uint256 xP = pm.coinPriceOfX(_newRate); /** @dev see iii6PriceMath.sol coinPriceOfX() :: line138 */
            require(xP > 0);
            rates[r] = Rates(r, xP, ocoin);
            r++;
            return rate = xP;
        } else if (ocoin == Coins.YYY) {
            uint256 yP = pm.coinPriceOfY(_newRate); /** @dev see iii6PriceMath.sol coinPriceOfY() :: line138 */
            require(yP > 0);
            rates[r] = Rates(r, yP, ocoin);
            r++;
            return rate = yP;
        } else if (ocoin == Coins.USDC) {
            uint256 newRate = pm.coinPriceOfUSD(_newRate); /** @dev see iii6PriceMath.sol coinPriceOfUSD() :: line138 */
            rates[r] = Rates(r, newRate, ocoin);
            r++;
            return rate = newRate;
        } else {
            return rate;
        }
    }

    /**
     * @dev sets the denomination currency
     * @param // INTERNAL
     * @param _curr  ocoin (denomination currency) // 0-eth 1-gascoin 2-xCur 2-yCur >4-usdc
     * denomination currency can be set in setCurr()
     * @return Coins.[???] // ocoin name as enum Coins
     */
    function _setCurr(uint256 _curr) internal returns (Coins) {
        if (_curr == 0) {
            ocoin = Coins.WETH;
        } else if (_curr == 1) {
            ocoin = Coins.GASCOIN;
        } else if (_curr == 2) {
            ocoin = Coins.XXX;
        } else if (_curr == 3) {
            ocoin = Coins.YYY;
        } else {
            ocoin = Coins.USDC;
        }
        return ocoin;
    }

    /**
     * @dev overrides ERC20 & ERC20Pausable
     */
    function _beforeTokenTransfer(
        address from,
        address to,
        uint256 amount
    ) internal override(ERC20, ERC20Pausable) whenNotPaused {
        super._beforeTokenTransfer(from, to, amount);
    }

    // ██████╗░██╗░░░██╗██████╗░██╗░░░░░██╗░█████╗░  ███████╗███╗░░██╗██╗░░██╗
    // ██╔══██╗██║░░░██║██╔══██╗██║░░░░░██║██╔══██╗  ██╔════╝████╗░██║╚██╗██╔╝
    // ██████╔╝██║░░░██║██████╦╝██║░░░░░██║██║░░╚═╝  █████╗░░██╔██╗██║░╚███╔╝░
    // ██╔═══╝░██║░░░██║██╔══██╗██║░░░░░██║██║░░██╗  ██╔══╝░░██║╚████║░██╔██╗░
    // ██║░░░░░╚██████╔╝██████╦╝███████╗██║╚█████╔╝  ██║░░░░░██║░╚███║██╔╝╚██╗
    // ╚═╝░░░░░░╚═════╝░╚═════╝░╚══════╝╚═╝░╚════╝░  ╚═╝░░░░░╚═╝░░╚══╝╚═╝░░╚═╝

    /**
     * @dev sets the denomination currency
     * @param // EXTERNAL
     * @param _curr  ocoin (denomination currency) // 0-eth 1-gascoin 2-xCur 2-yCur >4-usdc
     * denomination currency can be set in setCurr()
     * @return Coins.[???] // ocoin name as enum Coins
     */
    function setCurr(uint256 _curr) external onlyOwner returns (Coins) {
        return _setCurr(_curr);
    }

    /**
     * @dev sets the rate of currency in denomination currency
     * @dev check the ocoin for its state to determine what value to type in
     * @param // EXTERNAL
     * @param _rate  ocoin (denomination currency) // 0-eth 1-gascoin 2-xCur 2-yCur >4-usdc
     * denomination currency can be set in setCurr()
     * @return _setRate // ocoin name as enum Coins
     */
    function setRate(uint256 _rate) external onlyOwner returns (uint256) {
        return _setRate(_rate);
    }

    /**
     * @dev sets the max supply
     * @param // EXTERNAL only owner
     * @param _newSupply  ocoin (denomination currency) // 0-eth 1-gascoin 2-xCur 2-yCur >4-usdc
     * denomination currency can be set in setCurr()
     * @return Max Supply
     */
    function setMaxSupply(uint256 _newSupply)
        external
        onlyOwner
        returns (uint256)
    {
        return MAX_SUPPLY = _newSupply;
    }

    /**
     * @dev burn function for token holders only for burnable contracts
     * @param _amount of tokens to burn // EXTERNAL
     */
    function burn(uint256 _amount) public override {
        require(burns == true, "not burnable");
        _burn(msg.sender, _amount);
    }

    /**
     * @dev toggle the pausable functionality on the contract
     * @return pausable state of contract
     */
    function togglePause() public onlyOwner returns (bool) {
        return pauses = !pauses;
    }

    /**
     * @dev toggle the burnable functionality on the contract
     * @return burnable state of contract
     */
    function toggleBurn() public onlyOwner returns (bool) {
        return burns = !burns;
    }

    /**
     * @dev if contract pauses the state get checked and toggled via condition to opposite state
     * @return active state of contract (true = paused / false = active)
     */
    function toggleState() public onlyOwner returns (bool) {
        require(pauses == true, "not pausable");
        if (paused()) _unpause();
        else _pause();
        return paused();
    }

    /**
     * @dev buy function for token holders
     * @param _amount of tokens to mint // EXTERNAL
     * @return uint total price
     */
    function buyTokens(uint256 _amount) external payable returns (uint256) {
        require(msg.value >= _amount * rate, ":: insufficient balance ::");
        require(
            (MAX_SUPPLY - PUB_SUPPLY) - (_amount * 10**18) > 0,
            ":: insufficient tokens ::"
        );
        _mint(msg.sender, _amount * 10**18);
        return _amount * rate;
    }

    /**
     * @dev recieve function returns tokens on gascoin transfer to contract
     */

    receive() external payable {
        // condition
        _rcMint();
    }

    /**
     * @dev recieve function returns tokens on gascoin and/or tokens transfer to contract
     */
    fallback() external payable {
        // condition
        _rcMint();
        // condition
        _fbMint();
    }

    /**
     * @dev does mint  in exchange for gascoin action on recieve() and fallback()
     */
    function _rcMint() internal {
        uint256 amount = msg.value / rate;
        _mint(msg.sender, amount);
    }

    /**
     * @dev does mint in exchange for erc20 tokens action on recieve() and fallback()
     */
    function _fbMint() internal {
        // else if() { // ROADMAP
        // handle erc20 tokens
        // get token address
        // check for oracle
        // go to oracle list for network
        // check if address is listed or exit empty
        // connect X Custom Token to oracle address
        // check for price
        uint256 input = 0; // amount input from token x to amount of gascoins
        // determine tAmount
        uint256 tAmount = input / rate;
        // check if input sufficient
        require(tAmount > rate);
        // check if tokens available
        require(
            (MAX_SUPPLY - PUB_SUPPLY) - (tAmount) > 0,
            ":: insufficient tokens ::"
        );
        _mint(msg.sender, tAmount);
    }
}

contract iii6CoinModelDrop is iii6CoinModel {
    /**
     * @dev creates an instance of iii6CoinModel
     * @param _name token name
     * @param _sym token symbol
     * @param _rate token rate
     * @param _supply max token supply // if 0-infinte
     * @param _burn bool burnable
     * @param _pause bool pauseble
     * @param _curr denomintaor currency // 0-eth 1-gascoin 2-xCur 2-yCur >4-usdc
     */
    constructor(
        string memory _name,
        string memory _sym,
        uint256 _rate,
        uint256 _supply,
        bool _burn,
        bool _pause,
        uint256 _curr
    ) iii6CoinModel(_name, _sym, _rate, _supply, _burn, _pause, _curr) {}

    /**
     * @dev Drops users 100 Full Tokens For testnets only
     */
    function dropToken() external {
        _mint(msg.sender, 100 * 10**18);
    }
}
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//
//      MMWKd:..                                                                                    ..:dKWMM
//      MKl.                                                                                            .lKW
//      O'       ..''''''''''''.     .''''''.     .'''''.      .''''''''''''''.     .''''''''''''..       'O
//      '     .ckKNNWNWWWWWWWWWk.   .xNWWNWNl    ,0WWWWW0,     lNWWWWWWWWWNWNk'    ;0NNNWWWWWWWWNNKkc.     '
//           ,OWMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMMMM0,    ;KMMMMMMMMMMMMMMMMWO,
//          .kMMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMMM0,    ;KMMMMMMMMMMMMMMMMMMMk.
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMM0,    :KMMMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMM0,    :KMMMMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMM0,    ;0NNWWMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMM0,     .'.',;lkNMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMK;              ,kWMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMX:    .:oxxdc'    .dWMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMWd.   ,OWMMMMMXl.   '0MMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMX;   .kMMMMMMMMK,   .xMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMM0'   .OMMMMMMMMX;   .xMMMMMMMMMMMM0'
//          .OMMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMK,    lNMMMMMMWx.   '0MMMMMMMMMMMMO.
//           lNMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMWd.   .:x0KKKkc.   .dWMMMMMMMMMMMNl
//      .    .c0WMMMMMMMMMMMMMMO.   .kMMMMMWo    ,KMMMMMK,     lWMMMMNd.     ....     .xNMMMMMMMMMMW0c.    .
//      l      .,lddxxxxxxxxxxxc.    :xxxxxd,    .lxxxxxl.     ,dxxxxxd:.            .cdxxxxxxxxddl,.      l
//      No.                                                                                              .oN
//      MW0l'                                                                                          'l0WM
//      MMMWKd;.                                                                                    .;dKWMMM
//
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
